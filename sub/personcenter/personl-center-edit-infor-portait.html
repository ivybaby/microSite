<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>头像</title>
    <link  rel="stylesheet" href="../../css/reset.css">
    <link  rel="stylesheet" href="../../css/siteStyle.css">
    <script type="text/javascript" src="../../js/jquery-1.8.3.min.js" ></script>
   
	<style>
	
	#file,
	#clipBtn {
		display: none;
	}
	#view {
		margin: 0 auto;
		position: relative;
	}
	#view img{width: 100%;}
	#functBar{height:44px; position: absolute;bottom: 0; font-size: 18px;}
	#functBar a{display: inline-block;line-height: 44px;}
	</style>
	<!--[if IE]>
		<script src="http://libs.useso.com/js/html5shiv/3.7/html5shiv.min.js"></script>
	<![endif]-->
    
</head>
<body style="background: #000000;">
<div id="headPorIndex">
    <!--nav start-->
    <nav class="nav">
        <a href="javascript:history.go(-1)" class="nav-left" ><img src="../../img/back_icon.png" alt="back_icon" /></a>
        <h1 class="text-center">头像</h1>
        <a href="#" class="nav-right upload-icon" style="color: #FFFFFF;font-size: 22px;top:4px;">&bull;&bull;&bull;</a>
    </nav>
    <!--nav end-->
    
    <!--form start-->
    <form action="#" name="" style="margin-top: 0;">
		   <div id="clipArea"></div>
		   <input type="file" id="file" style="display: none;">
		   <button id="clipBtn">截取</button>
		   <div id="view">
		   	 <img src="../../img/media_1.jpg"  />
		   </div>
		   <div class="row row-padding" id="functBar">
		   	  <a href="#" class="text-white pull-left bar-cancle">取消</a>
		   	  <a href="#" class="text-white pull-right bar-clip">完成</a>
		   </div>
    </form>
    <!--form end-->
</div>

	<script src="../../js/photoclip/iscroll-zoom.js"></script>
	<script src="../../js/photoclip/hammer.js"></script>
	<script src="../../js/photoclip/jquery.photoClip.js"></script>
	<script>
	$(function(){
		var screenHeight=document.body.scrollHeight;//屏幕的高度
		var screenWidth=document.body.scrollWidth;//屏幕的宽度
		
		var actHeight=screenHeight-$(".nav").outerHeight();
		
		$("#clipArea").css({"height":actHeight+'px',"width":screenWidth+'px'});
		
 		$(".upload-icon").on("click",function(e){
 			e.preventDefault();
 			$("#file").click();
 		});
 		//取消按钮
 		$(".bar-cancle").on("click",function(e){
 			e.preventDefault();
 			$("#view,.nav").show();
			$("#clipArea,#functBar").hide();
 		});
 		
 		//document.addEventListener('touchmove', function (e) { e.preventDefault(); }, false);
	    $("#clipArea").photoClip({
		   width:screenWidth,
		   height:screenWidth,
		   file: "#file",
		   view: "#view",
		   ok: "#clipBtn",
		   loadStart: function() {
			   console.log("照片读取中");
		   },
		   loadComplete: function() {
			   console.log("照片读取完成");
		   },
		   clipFinish: function(dataURL) {
			   console.log(dataURL);
		   }
	    });
	    $("#clipArea,#functBar").hide();
	    var marTop=parseFloat((actHeight-screenWidth)/2);

	    $("#view").css({"height":screenWidth+'px',"width":screenWidth+'px',"margin-top":marTop+'px'});
 		$(".bar-clip").on("click",function(e){
 			e.preventDefault();
 			$("#clipBtn").click();
 			$("#view,.nav").show();
			$("#clipArea,#functBar").hide();
 		});
 	})
	
	</script>
</body>
</html>